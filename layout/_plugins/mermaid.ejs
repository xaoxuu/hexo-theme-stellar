<script defer type="text/javascript" src="<%- conf.js %>"></script>
<script>
  utils.initPlugin(() => {
    const els = document.querySelectorAll('.mermaid');
    if (els.length > 0) {
      const mermaid_config = {
        startOnLoad: false,
        theme:
          "<%- theme.style.prefers_theme %>" == "auto" &&
            window.matchMedia("(prefers-color-scheme: dark)").matches
            ? "dark"
            : "<%- conf.theme %>",
        logLevel: 3,
        themeVariables: {
          darkMode: true
        },
        flowchart: {
          useMaxWidth: false,
          htmlLabels: true,
          curve: "linear"
        },
        gantt: {
          axisFormat: "%Y/%m/%d"
        },
        sequence: {
          actorMargin: 50
        }
      }
      mermaid.initialize(mermaid_config);
      mermaid.run();
    }
  }, 'mermaid');
</script>